/* --- Preloader Styles --- */
.preloader-overlay {
    position: fixed; /* Covers the entire viewport */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #000; /* Solid black background */
    z-index: 9999; /* Ensures it's on top of everything */
    display: flex; /* Use flexbox for centering content */
    flex-direction: column; /* Stack spinner and text vertically */
    justify-content: center; /* Center vertically */
    align-items: center; /* Center horizontally */
    color: #fff; /* White text color */
    font-family: 'Press Start 2P', cursive; /* Match your pixel font if you have it */
    font-size: 1.2em;
    transition: opacity 0.5s ease-out, visibility 0.5s ease-out; /* Smooth fade-out effect */
}

/* Optional: Styles for the preloader spinner */
.preloader-spinner {
    border: 8px solid rgba(255, 255, 255, 0.3); /* Light border */
    border-top: 8px solid #fff; /* Solid white top border for animation */
    border-radius: 50%; /* Make it round */
    width: 60px;
    height: 60px;
    animation: spin 1.5s linear infinite; /* Spin animation */
    margin-bottom: 20px; /* Space between spinner and text */
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Class to hide the preloader after loading */
.preloader-overlay.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none; /* Prevents interaction with hidden overlay */
}

/* --- Global Resets & True Full Viewport Fill --- */
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden; /* Prevent scrollbars */
    font-family: 'Inter', sans-serif;
    background-color: #000000; /* This color will show in the "letterbox" areas */

    position: fixed; /* Fixes html/body to the viewport, ignoring scrollbar calculations */
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;

    /* Use flexbox to center map-container within this fixed viewport */
    display: flex;
    justify-content: center; /* Center horizontally */
    align-items: center;   /* Center vertically */
}

/* --- Main Map Container --- */
#map-container {
    position: relative;
 
    width: min(100vw, calc(100vh * (544 / 384)));
    height: min(100vh, calc(100vw * (384 / 544)));

    /* The aspect-ratio property is still useful as a fallback/reinforcer,
       but the width/height calculations above are doing the heavy lifting. */
    aspect-ratio: 544 / 384; 
    
    /* Ensure flex items don't overflow when they have intrinsic aspect ratios */
    min-width: 0; 
    min-height: 0;
    
    background-image: url('map.png');
    background-size: contain; /* Ensure the full map image is visible within the container */
    background-position: top center;
    background-repeat: no-repeat;
    border-radius: 0;
    box-shadow: none;
    overflow: hidden; /* Crucial to clip any content that goes beyond the container */
    margin: auto; /* Re-add auto margin with flexbox if using max-width/height */
    z-index: 1;
}

/* ... (rest of your CSS for clickable-area, cars, sprites, modal remain the same) ... */

.clickable-area {
    position: absolute;
    background-color: rgba(0, 123, 255, 0.0);
    cursor: pointer;
    border-radius: 6px;
    transition: background-color 0.2s ease-in-out, transform 0.1s ease-out;
    z-index: 10;
}

.clickable-area:hover {
    background-color: rgba(0, 123, 255, 0.2);
    transform: scale(1.02);
}

#taxi-moving-car,
#red-moving-car,
#green-moving-car {
    position: absolute;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    z-index: 5;
    will-change: transform, left, top;
}

#taxi-moving-car { background-image: url('anim/car/taxi-right.png'); }
#red-moving-car { background-image: url('anim/car/red-car-right.png'); }
#green-moving-car { background-image: url('anim/car/green-car-right.png'); }

.walking-sprite {
    position: absolute;
    width: 16px;
    height: 16px;
    background-repeat: no-repeat;
    overflow: hidden;
    z-index: 6;
    transform-origin: bottom center;
    will-change: transform, left, top, background-position;
}

.walking-sprite.hidden-by-flag {
    display: none;
}

#boy-walking-sprite-1, #boy-walking-sprite-2 { background-image: url('anim/people/boy.png'); }
#girl-walking-sprite-1, #girl-walking-sprite-2, #girl-walking-sprite-3 { background-image: url('anim/people/girl.png'); }
#man-walking-sprite { background-image: url('anim/people/man.png'); }
#worker-walking-sprite-1, #worker-walking-sprite-2 { background-image: url('anim/people/worker.png'); }

/* This is the main full-screen container */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1000;
    background-color: #000; /* Solid black fallback */
    
    /* Controls visibility */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s ease-out, visibility 0s 0.5s;
}

.modal-overlay.visible {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.5s ease-out;
}

/* The video that plays BEHIND the content */
.modal-background-video {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    min-width: 100%;
    min-height: 100%;
    width: auto;
    height: auto;
    z-index: 1; /* Sits behind the modal content */
    opacity: 0.7; /* Optional: slightly dim the video */
}

/* The content container that sits ON TOP of the video */
.modal-content {
    position: relative; /* Must be relative to use z-index */
    z-index: 2; /* Ensures content is on top of the video */
    width: 100%;
    height: 100%;
    padding: 4rem 5rem; /* More padding for a spacious feel */
    box-sizing: border-box;
    overflow-y: auto; /* Allow scrolling for long content */
    background-color: rgba(0, 0, 0, 0.5); /* Dark overlay for text readability */
    color: #ffffff; /* White text for contrast */
}

/* Updated close button for the new design */
.modal-close-btn {
    position: absolute;
    top: 2rem;
    right: 2rem;
    background: none;
    border: none;
    font-size: 2.5rem;
    cursor: pointer;
    color: #fff;
    opacity: 0.7;
    transition: opacity 0.2s, transform 0.2s;
}

.modal-close-btn:hover {
    opacity: 1;
    transform: scale(1.1);
}

/* Updated text styles for the new design */
#modal-title {
    color: #ffffff;
    font-size: 3rem; /* Larger title */
    font-weight: 700;
    margin-bottom: 2rem;
    border-bottom: 2px solid rgba(255, 255, 255, 0.5); /* Underline effect */
    padding-bottom: 1rem;
}

#modal-body {
    line-height: 1.7;
    font-size: 1.1rem;
    max-width: 900px; /* Constrain line length for readability */
}

/* Ensure links in the modal are also visible */
#modal-body a {
    color: #87CEEB; /* A nice light blue for links */
    text-decoration: underline;
}

/* Tailwind-like classes */
.text-3xl { font-size: 2.25rem; }
.font-bold { font-weight: 700; }
.text-center { text-align: center; }
.mb-6 { margin-bottom: 1.5rem; }
.text-2xl { font-size: 1.875rem; }
.font-semibold { font-weight: 600; }
.mb-4 { margin-bottom: 1rem; }
.text-base { font-size: 1rem; }
.leading-relaxed { line-height: 1.625; }